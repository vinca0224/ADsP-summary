# R 기초와 데이터 마트

---

- R의 기본적인 기능 학습
- 데이터 마트의 이해와 파생변수, 요약변수의 개념 이해
- 데이터의 특성 이해
- 결측치와 이상치의 처리방법

---

R 은 오픈소스이며, 다양한 통계기법을 다룰 수 있으며, 데이터 시각화에 최적화되어있다.

R의 데이터 타입

- 문자형(character) : 따옴표, 쌍따옴표로 표시
    - class() : 데이터 타입을 문자열로 반환
- 숫자형
    - numeric(숫자형)
    - double(실수)
    - integer(정수)
    - complex(복소수)
    - Inf(양의 무한대), -Inf(음의 무한대)
- 논리형(logical) : 참(TRUE)과 거짓(FALSE)
- NaN, NA, NULL
    - NaN(Not a Number) : 숫자가 아님(음수의 제곱근 등)
    - NA(Not Available), NULL : 결측값
        - NA는 하나의 공간을 차지하는 결측값이지만, NULL은 공간을 차지하지 않는다.

---

R 기본 문법

- 연산자
    - 대입 연산자 : 변수에 값을 할당
        - <<, ←, = : 오른쪽 값을 왼쪽에 대입 ; >>, → : 왼쪽 값을 오른쪽에 대입
    - 비교 연산자
        - NA는 어떤 것과 비교하더라도 NA를 반환
        - is.타입 : 타입인지 아닌지 비교
    - 산술연산자 : 계산
    - 기타 연산자 : ! → 부정 연산자, & → AND 연산자, | → OR 연산자

---

R 데이터 구조

- **벡터** : 하나의 행으로 되어있는 **1차원** 데이터 구조
    - c를 써서 데이터를 묶거나, 콜론을 활용하여 시작값과 끝값을 지정해 생성할 수 있다
        - v1 = c(3, ‘a’, TRUE),  v2 = c(1:6)
- **행렬** : 행과 열로 구성된 2차원 구조, 행렬에 저장된 모든 데이터는 같은 타입이여야 한다.
    - 만약 같은 타입이 아니면 자동으로 타입변환을 수행
    - matrix 함수를 사용하여 행렬을 만들시 nrow, ncol을 사용해 행과 열의 수 결정
        - m1 = matrix(c(1:6), nrow=2
        - 기본 값은 열로 저장되나, byrow를 TRUE로 설정하면 행으로 저장
    - dim 함수를 사용하여 벡터에 차원을 주어서 행렬을 만들 수 있다
        - v1 = c(1:6),  dim(v1)= c(2,3)
- **배열** : 3차원 이상의 구조를 갖는 벡터, 행렬에 저장된 모든 데이터는 같은 타입이여야 한다.
    - array 함수를 이용해 배열을 만들수 있고 몇차원 구조를 갖는지 dim 옵션에 명시해야함
    - dim함수를 이용하여 벡터에 차원을 주어서 행렬을 만들 수 있다.
- **리스트** : **데이터 타입과 구조에 상관없이** 모든 것을 저장할 수 있는 자료 구조
    - l = list(),  l[[1]] = 5,  l[[2]] = c(1:5),  …
- **데이터프레임** : 2차원 구조를 갖는 관계형 **데이터 구조, 각 열은 다른 타입의 데이터를 가질 수 있음**
    - v1 = c(1,2,3),  v2=c(’a’,’b’,’c’) df1 = data.frame(v1, v2)

---

R 통계함수

![https://velog.velcdn.com/images/hi_pitt/post/4d53bddc-f723-4388-ba57-fa140a2e45df/image.png](https://velog.velcdn.com/images/hi_pitt/post/4d53bddc-f723-4388-ba57-fa140a2e45df/image.png)

---

데이터의 결합

- rbind : 행으로 결합, cbind : 열로 결합
- 행렬:행렬, 데이터프레임:데이터프레임의 경우 행의 수나 열의 수가 같을 경우 결합 가능
- 벡터:벡터의 결합은 재사용 규칙으로 인해 부족한 데이터를 앞에서부터 다시 재활용

---

제어문

- for
- while

조건문

- if

함수 선언

- (함수명) = function(){함수 내용}

---

데이터 전처리 함수

- subset : 데이터에서 조건식에 맞는 데이터 추출
- merge : 두 데이터를 공통된 열을 기준으로 병합
- apply : 데이터를 열이나 행 별로 주어진 함수를 적용

---

**데이터 마트**는 데이터 웨어하우스로부터 특정 사용자가 데이터들을 주제별, 부서별로 모은 비교적 작은 규모의 데이터 웨어하우스이다.

주제별, 부서별로 데이터를 수집하고 변형해 한 곳에 모으는 작업을 데이터 마트 개발이라 한다.

데이터 전처리는 **정제**와 **변수 처리**를 포함하는 광의의 개념이다.

데이터의 정제는 크게 **이상값과 결측치를** 처리하는 내용이고, 분석 변수 처리는 변수 선택, 차원축소, 변수 변환, 불균형 데이터 처리 등으로 이루어진다.

**요약변수**는 기존의 데이터로부터 기본적인 통계자료를 추출한 변수라면, **파생변수**는 특정한 목적을 가지고 새롭게 생성한 특정한 의미가 부여된 함수이다.

---

R 패키지

- reshape : melt와 cast 함수를 이용하여 데이터를 가공
- sqldf : sql 문장을 활용하여 데이터프레임을 다룸
- pylr : apply 함수를 기반으로 데이터를 분리, 결합, ddply함수를 많이 이용
- data.table : 특정 칼럼별로 주솟값을 갖는 인덱스를 생성하여 연산과 검색을 빠르게 수행

---

**결측값**은 존재하지 않는 데이터이다.

결측값의 대치 방법

- **단순 대치법** : 결측값이 존재하는 데이터 삭제, 대량의 데이터 손실 발생 가능
- **평균 대치법** : 평규 혹은 중앙값으로 결측치를 대치
    - 비조건부 평균 대치법 : 데이터의 평균값으로 결측값을 대치
    - 조건부 평균 대치법 : 실제 값을 분석하여 회귀분석을 활용
- **단순 확률 대치법**
    - K-Nearest Neighbor : 주변 K개의 데이터 중 가장 많은 데이터로 대치, K선정의 어려움
- **다중 대치법** : 여러번의 대치를 통해 n개의 임의 완전자료를 만듬
    - 결측값 대치, 분석 결합의 단계를 거침

---

**이상값**은 극단적으로 크거나 작은 값을 의미한다.’

이상값 판단 방법

- **ESD**(Extreme Studentized Deviation) : 표준편차 3만큼 떨어진 값을 이상값으로 인식
    - 99.7%의 자료들은 표준편차 3 안에 위치, 나머지 0.3%를 이상값으로 판단
    
    [https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https%3A%2F%2Fblog.kakaocdn.net%2Fdn%2FY2VGP%2FbtqB5EIdzlc%2FMHPyNI8XuYX5dnXBossIRk%2Fimg.png](https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https%3A%2F%2Fblog.kakaocdn.net%2Fdn%2FY2VGP%2FbtqB5EIdzlc%2FMHPyNI8XuYX5dnXBossIRk%2Fimg.png)
    
- **사분위수** : 25%에 해당하는 값(Q1) 과 75%에 해당하는 값(Q3)를 활용하여 이상치 판단
    - IQR : 사분범위; Q1 ~ Q3 사이의 값
    - 사분범위에서 1.5분위수를 벗어날 경우 이상값으로 판단
        - Q1-1.5 IQR 보다 작거나, Q3 + 1.5 IQR 보다 큰 값
    
    ![https://postfiles.pstatic.net/20140307_296/cooroom_1394165696954OhLTl_PNG/Boxplot_vs_PDF.svg.png?type=w2](https://postfiles.pstatic.net/20140307_296/cooroom_1394165696954OhLTl_PNG/Boxplot_vs_PDF.svg.png?type=w2)