# 정형 데이터 마이닝 - 2

---

- 군집분석 학습
- 연관분석 및 연관분석의 알고리즘 및 특성 분석

---

**군집분석**은 유사한 자료들끼리 몇개의 군집으로 묶은 후 각 군집에 대한 특징을 파악하는 기법이다.

군집분석의 거리측도

1. 변수가 **연속형**인 경우
    - **유클리디안** 거리 : 두 점 사이의 가장 짧은 거리를 계산
    - **맨하튼** 거리 : 두 점 사이를 가로지르지 않고 길을 따라 값을 때의 거리
    - **체비셰프** 거리 : 변수 간 거리 차이 중 최대값
    - 표준화 거리 ㅣ 유클라디안 거리에서 표준편차로 나눈 거리
    - 마할라노비스 거리 : 변수의 상관성을 고려한 거리
    - 민코프스키 거리 : 유클라디안 거리(m=1)와 맨하튼 거리(m=2)를 한번에 표현
2. 변수가 **범주형**인 경우
    - 단순 일치 계수 : 두 객체간 상이성을 불일치 비율로 계산
    - 자카드 지수 : 두 집합 사이의 유사도 측정
    - 자카드 거리 : 1에서 자카드 지수를 뺀 값
    - 코사인 유사도 : 문서의 유사도 측정, 방향성을 측정하는 지표
    - 코사인 거리 : 코사인 유사도의 거리화
    - 순위 상관계수 : 순서척도인 두 데이터 사이의 거리를 측정

---

**계층적 군집분석**은 가까운 관측치부터 결합해나가면서 계층적 트리구조를 형성하여 군집화를 수행한다.

- 병합적 방법 : 각 데이터를 하나의 군집으로 간주하여 순차적 병합
- 분할적 방법 : 전체 데이터를 하나의 군집으로 간주하여 순차적 분할

군집 간의 거리

- 단일연결법 : 최단 연결법
- 완전연결법 : 최장연결법
- 평균연결법 : 거리를 군집 내 평균 데이터로 계산
- 중심연결법 : 각 군집의 중심점 사이의 거리
- 와드연결법 : 군집 내 오차가 최소가 되는 데이터로 계산

---

비계층적 군집분석 : 구하고자 하는 군집의 수를 사전에 정해 정해진 수만큼 군집을 형성

- k-means 군집 : 군집의 수(k)를 사전에 정한 뒤 전체 데이터를 k개의 군집으로 분할
    1. 군집의 수 설정, 데이터 중 k개를 선택(seed)
    2. 각 데이터를 가장 가까운 seed로 할당
    3. 각 군집의 데이터들 사이의 평균 값이나 중앙값을 계산 후 새로운 시드 설정
    4. 새로운 시드를 중심으로 군집 재할당
    5. 모든 데이터가 이상적으로 군집화 될 때까지 반복
    - 적용이 단순하고 빠르며, 다양한 데이터에서 사용가능하다.
    - 초기값 설정이 어렵고 이상값에 민감하게 반응한다, 변수가 연속형 변수여야 한다.
- K-medoids : k-평균의 단점 보완
    - 시드 값은 반드시 데이터 중에 선택, 시드의 이동은 클러스터 내 다른 데이터와의 거리척도가 최소가 되는 데이터 선택
- DBSCAN : 개체들이 밀집한 정도에 기초해 군집형성, 군집의 형태에 구애받지않음

---

혼합 분포 군집

**EM 알고리즘**(기댓값 최대화)는 확률모델의 최대가능도를 갖는 모수와 함께 그 확률모델의 가중치를 추정

1. 파라미터(모수) 설정 : 두 개의 정규분포로 혼합된다고 가정할 경우 초기 파라미터 값 임의 설정
2. 잠재 변수 Z의 기댓값 계산 : 로그 가능도 함수의 기댓값 계산
3. 새로운 파라미터 추정
4. 알고리즘 반복 및 종료

---

자기조직화지도(SOM) : 인공신경망 기반 차원축소와 군집화를 동시에 수행

- 은닉층이 없이 입력층과 경쟁층으로 구성되어 있음
- 입력층의 모든 데이터는 경쟁층의 모든 노드와 완전연결
- 속도가 매우 빠르지만, 초기 가중치에 많은 영향을 받고 노드 개수를 정하기 어렵다.
- 각 학습단계마다 거리를 비교하여 최종적으로 경쟁층 노드 중 가장 가까운 하나의 노드에 도달 → 승자노드
- SOM 과정
    1. 초기 학습률, 가중치 행렬, 경쟁층 노드 개수 지정
    2. 입력 벡터를 제시하고 가장 가까운 노드에 나타냄
    3. 승자노드가 입력 벡터를 잘 나타내도록 해당 가중치 재조정
    4. 모든 입력벡터를 승자노드에 나타냄
    5. 일정 반복수에 도달할 때 까지 반복

---

**연관분석**(장바구니 분석)은 패턴을 분석하여 의미있는 규칙을 찾아낸다.

- 사용이 편리하고 계산이 간단하나 품목 수가 증가하면 분석 계산이 기하급수적으로 증가한다.
- 지지도 : A와 B 두 품목이 동시에 포함된 비율
    - 지지도가 높으면 두 아이템이 같이 잘 팔린다는 뜻이다.
    
    $$
    지지도 = P(A \cap B)
    $$
    
- 신뢰도 : 하나가 구매될 떄, 다른 하나가 구매될 확률, 조건부 확률
    - A가 구매될 때 B가 구매될 확률의 신뢰도와, B가 구매될 때 A가 구매될 확률의 신뢰도는 **다르다.**
    
    $$
    신뢰도 = \frac{P(A \cap B)}{P(A)} = \frac{지지도}{P(A)}
    $$
    
- 향상도
    - A가 주어지지 않을 때 B가 구매될 확률 대비 A가 구매될 때 B가 구매될 확룰
    - 향상도는 서로 같다
    - 향상도가 1보다 크면 양의 상관관계, 작으면 음의 상관관계를 갖는다.
    
    $$
    향상도 = \frac{P(A \cap B)}{P(A)P(B)} = \frac{지지도}{P(A)P(B)} = \frac{신뢰도}{P(B)}
    $$
    

---

연관분석의 알고리즘

- apriori 알고리즘 : 지지도를 사용해 빈발 아이템 집합을 판별
    1. 최소 지지도 설정
    2. 최소 지지도보다 큰 지지도를 갖는 단일 품목 선별
    3. 찾은 단일 품목으로 2가지 품목으로 생성되는 연관 규칙 중 최소지지도 이상의 규칙을 찾음
    4. 반복 수행하면서 의미 도출
- FP - Growth 알고리즘 : 지지도가 낮은 품목부터 높은 품목 순으로 빈도 수가 높은 아이템 집합 생성

연관분석의 특징

- 결과가 단순하고 분명하다
- 품목 세분화가 어렵고 품목 수 증가 시 계산량이 증가한다.